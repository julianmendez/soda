
directive lean
notation:max "Zero_ ()" => Nat.zero

directive lean
notation:max "Succ_" => Nat.succ

class TriangularNumberForLean

  abstract

  _tailrec_get_number (m : Nat) (acc : Nat) : Nat =
    match m
      case Succ_ (k) ==> _tailrec_get_number (k) (acc .add (Succ_ (k) ) )
      case otherwise ==> acc

  get_number (n : Nat) : Nat =
    _tailrec_get_number (n) (Zero_ () )

end

