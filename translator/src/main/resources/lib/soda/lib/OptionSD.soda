/*
 * This file is automatically generated. Do not edit.
 */

package soda.lib

/**
 * This is an Option implemented without exceptions.
 */
* OptionSD[A] = {

  has opt[B](ifEmpty: B, ifNonEmpty: A -> B): B

  has map[B](mapping: A -> B): OptionSD[B]

  has toOption: Option[A]

  isEmpty: Boolean = opt(ifEmpty := true, ifNonEmpty := element -> false)

  isDefined: Boolean = not isEmpty

  isNonEmpty: Boolean = not isEmpty

  toSeq: Seq[A] =
    opt(ifEmpty := Seq(), ifNonEmpty := element -> Seq(element))

  getOrElse(default: A): A =
    opt(ifEmpty := default, ifNonEmpty := element -> element)

  fold[B](ifEmpty: B, f: A -> B): B =
    opt(ifEmpty, f)

  flatMap[B](mapping: A -> OptionSD[B]): OptionSD[B] =
    opt(
      ifEmpty := NoneSD_[B](),
      ifNonEmpty := element -> mapping(element)
    )

  bind[B](mapping: A -> OptionSD[B]): OptionSD[B] =
    flatMap[B](mapping)

  filter(predicate: A -> Boolean): OptionSD[A] =
    opt(
      ifEmpty := this,
      ifNonEmpty := element -> if predicate(element) then this else NoneSD_[A]()
    )
}

* NoneSD[A] extends OptionSD[A] = {

  opt[B](ifEmpty: B, ifNonEmpty: A -> B): B =
    ifEmpty

  map[B](mapping: A -> B): NoneSD[B] =
    NoneSD_[B]()

  toOption: None.type = None
}

* NoneSD_[A]() extends NoneSD[A]

* SomeSD[A] extends OptionSD[A] = {

  has element: A

  value: A = element

  opt[B](ifEmpty: B, ifNonEmpty: A -> B): B =
    ifNonEmpty(element)

  map[B](mapping: A -> B): SomeSD[B] =
    SomeSD_[B](mapping(element))

  toOption: Some[A] = Some[A](element)
}

* SomeSD_[A](element: A) extends SomeSD[A]

* OptionSDBuilder[A] = {

  build(option: Option[A]): OptionSD[A] =
    if option.isEmpty
    then NoneSD_[A]()
    else SomeSD_[A](option.get)
}

* OptionSDBuilder_[A]() extends OptionSDBuilder[A]

