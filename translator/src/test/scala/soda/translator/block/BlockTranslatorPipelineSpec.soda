package soda.translator.block

* BlockTranslator00 ()
  extends BlockTranslator = {

  + soda.translator.parser.BlockBuilder_

  source: String = "00"

  target: String = "01"

  translate (block: Block): Block =
    BlockBuilder_ ().build (
      if block.lines.isEmpty
      then Seq ("")
      else block.lines.++ ( Seq ("tr00") )
    )

}

* BlockTranslator01 ()
  extends BlockTranslator = {

  + soda.translator.parser.BlockBuilder_

  source: String = "01"

  target: String = "02"

  translate (block: Block): Block =
    BlockBuilder_ ().build (
      if block.lines.isEmpty
      then Seq ("")
      else block.lines.++ ( Seq ("tr01") )
    )

}

* BlockTranslator02 ()
  extends BlockTranslator = {

  + soda.translator.parser.BlockBuilder_

  source: String = "02"

  target: String = "03"

  translate (block: Block): Block =
    BlockBuilder_ ().build (
      if block.lines.isEmpty
      then Seq ("")
      else block.lines.++ ( Seq ("tr02") )
    )

}

* BlockTranslatorPipelineSpec ()
  extends org.scalatest.funsuite.AnyFunSuite = {

  + soda.translator.parser.BlockBuilder_

  instance =
    BlockTranslatorPipeline_ (
      Seq (
        BlockTranslator00 (),
        BlockTranslator01 (),
        BlockTranslator02 ()
      )
    )

  test("block translator pipeline")
    let
      original = BlockBuilder_ ().build (
        Seq ( "first line" )
      )
      expected =
        BlockBuilder_ ().build (
          Seq (
            "first line",
            "tr00",
            "tr01",
            "tr02"
          )
        )
      obtained = instance.translate (original)
    in assert (obtained == expected)

}

