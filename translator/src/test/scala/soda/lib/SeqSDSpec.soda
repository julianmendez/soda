package soda.lib

+ org.scalatest.funsuite.AnyFunSuite

* SeqSDSpec() extends AnyFunSuite {


  test("should detect an empty sequence") {
    input = Seq()
    seqsd = SeqSDBuilder().build(input)
    obtained = seqsd.open(
      ifEmpty := true,
      ifNonEmpty := nonEmpty -> false
    )
    assert(obtained)
  }

  test("should detect an non empty sequence") {
    input = Seq(1)
    seqsd = SeqSDBuilder().build(input)
    obtained = seqsd.open(
      ifEmpty := false,
      ifNonEmpty := nonEmpty -> true
    )
    assert(obtained)
  }

  test("should get the maximum") {
    max_of_2(a: Int, b: Int): Int = if a > b then a else b
    max(s: NESeqSD[Int]): Int =
      Rec().foldLeft(s.tailSeq, s.head, max_of_2)

    input = Seq(2, 7, 1, 8, 2, 8, 1, 8, 2, 8, 4, 5, 9)
    expected = 9
    obtained = max(NESeqSD[Int](input.head, input.tail))
    assert(obtained == expected)
  }

}

