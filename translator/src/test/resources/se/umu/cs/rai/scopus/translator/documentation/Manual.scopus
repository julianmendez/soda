package se.umu.cs.rai.scopus.translator.documentation

import java.util.Date

import scala.annotation.tailrec


* Agent {
  has identifier: String
}

* Person (name: String)

* Agent_Person (name: String) extends Agent {
  identifier = name
}

* Ranked_Individual {
  has rank: Int
}

* Ranked_Agent_Person (name: String, person_rank: Int) extends Agent with Ranked_Individual {
  identifier = name

  rank = person_rank
}

* Element {
  has accept (v: Visitor): Boolean
}

* Visitor {
  has visit (x: Element): Boolean
}

* Item (identifier: Int) extends Element {
  accept (v: Visitor) = v.visit (this)
}

* Person_Name (name: String) {
  @override
  toString = name
}

/**
  * This contains the examples shown in the manual.
  */
* Manual() {

  a = 1

  b: Int = 2

  plus_one (x: Int): Int = x + 1

  max (x: Int, y: Int) =
    if x > y
    then x
    else y

  plus_one (sequence: Seq[Int]) =
    sequence.map(element -> element + 1)

  my_not (x: Boolean) =
    if x
    then false
    else true

  my_and (x: Boolean, y: Boolean) =
    if x
    then
      if y
      then true
      else false
    else false

  my_or (x: Boolean, y: Boolean) =
    if x
    then true
    else
      if y
      then true
      else false

  my_xor (x: Boolean, y: Boolean) = (x or y) and not (x and y)

  now = new Date()

  sum (n: Int) = sum_rec (n, 0)

  @tailrec
  sum_rec (n: Int, accum: Int): Int =
    if n < 0
    then accum
    else sum_rec (n - 1, n + accum)

}
