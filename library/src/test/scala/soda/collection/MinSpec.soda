package soda.collection


* MinSpec() extends org.scalatest.funsuite.AnyFunSuite = {
  + soda.lib.OptionSD
  + soda.lib.NoneSD
  + soda.lib.SomeSD
  + soda.lib.Rec

  empty: ESeq[Int] = ESeqImpl[Int]()
  exampleSeq: Seq[Int] = Seq(0, 1, 1, 2, 3, 5, 8)
  revExampleSeq: Seq[Int] = exampleSeq.reverse

  prepend_elem(list: MSeq[Int], elem: Int) = MinImpl().prepended(list, elem)
  example: NESeq[Int] =
    Rec().foldLeft(revExampleSeq.tail,
      NESeqImpl[Int](revExampleSeq.head, ESeqImpl[Int]()), prepend_elem )

  test("prepended") {
    expected = MSeqTranslatorImpl().asMSeq(Seq(1, 0, 1, 1, 2, 3, 5, 8))
    obtained = MinImpl().prepended(example, 1)

    assert(obtained == expected)
  }

  test("head") {
    expected = 0
    obtained = MinImpl().head(example)

    assert(obtained == expected)
  }

  test("tail") {
    expected = MSeqTranslatorImpl().asMSeq(Seq(1, 1, 2, 3, 5, 8))
    obtained = MinImpl().tail(example)

    assert(obtained == expected)
  }

  //

  test("reverse") {
    expected = MSeqTranslatorImpl().asMSeq(Seq(8, 5, 3, 2, 1, 1, 0))
    obtained = MinImpl().reverse(example)

    assert(obtained == expected)
  }

  test("length") {
    expected = 7
    obtained = MinImpl().length(example)

    assert(obtained == expected)
  }

  test("indexOf something found") {
    expected = 6
    obtained = MinImpl().indexOf(example, 8)

    assert(obtained == expected)
  }

  test("indexOf something not found") {
    expected = -1
    obtained = MinImpl().indexOf(example, 7)

    assert(obtained == expected)
  }

  test("contains something found") {
    expected = true
    obtained = MinImpl().contains(example, 8)

    assert(obtained == expected)
  }

  test("contains something not found") {
    expected = false
    obtained = MinImpl().contains(example, 7)

    assert(obtained == expected)
  }

  test("at") {
    expected = SomeSD(3)
    obtained = MinImpl().at(example, 4)

    assert(obtained == expected)
  }

  //

  test("take with Seq 0") {
    expected = Seq(0, 1, 1, 2, 3)
    obtained = exampleSeq.take(5)

    assert(obtained == expected)
  }

  test("take with Seq 1") {
    expected = Seq()
    obtained = exampleSeq.take(-100)

    assert(obtained == expected)
  }

  test("take with Seq 2") {
    expected = exampleSeq
    obtained = exampleSeq.take(100)

    assert(obtained == expected)
  }

  test("take 0") {
    expected = MSeqTranslatorImpl().asMSeq(Seq(0, 1, 1, 2, 3))
    obtained = MinImpl().take(example, 5)

    assert(obtained == expected)
  }

  test("take 1") {
    expected = empty
    obtained = MinImpl().take(example, -100)

    assert(obtained == expected)
  }

  test("take 2") {
    expected = example
    obtained = MinImpl().take(example, 100)

    assert(obtained == expected)
  }

  test("drop with Seq 0") {
    expected = Seq(2, 3, 5, 8)
    obtained = exampleSeq.drop(3)

    assert(obtained == expected)
  }

  test("drop with Seq 1") {
    expected = exampleSeq
    obtained = exampleSeq.drop(-100)

    assert(obtained == expected)
  }

  test("drop with Seq 2") {
    expected = Seq()
    obtained  = exampleSeq.drop(100)

    assert(obtained == expected)
  }

  test("drop 0") {
    expected = MSeqTranslatorImpl().asMSeq(Seq(2, 3, 5, 8))
    obtained = MinImpl().drop(example, 3)

    assert(obtained == expected)
  }

  test("drop 1") {
    expected = example
    obtained = MinImpl().drop(example, -100)

    assert(obtained == expected)
  }

  test("drop 2") {
    expected = empty
    obtained = MinImpl().drop(example, 100)

    assert(obtained == expected)
  }

  test("takeWhile with Seq") {
    expected = Seq(0, 1, 1, 2)
    f: Int -> Boolean = e -> not (e == 3)
    obtained = exampleSeq.takeWhile(f)

    assert(obtained == expected)
  }

  test("takeWhile") {
    expected = MSeqTranslatorImpl().asMSeq(Seq(0, 1, 1, 2))
    f: Int -> Boolean = e -> not (e == 3)
    obtained = MinImpl().takeWhile(example, f)

    assert(obtained == expected)
  }

  test("dropWhile with Seq") {
    expected = Seq(3, 5, 8)
    f: Int -> Boolean = e -> not (e == 3)
    obtained = exampleSeq.dropWhile(f)

    assert(obtained == expected)
  }

  test("dropWhile") {
    expected = MSeqTranslatorImpl().asMSeq(Seq(3, 5, 8))
    f: Int -> Boolean = e -> not (e == 3)
    obtained = MinImpl().dropWhile(example, f)

    assert(obtained == expected)
  }

  test("splitAt with Seq") {
    expected = Tuple2(Seq(0, 1, 1), Seq(2, 3, 5, 8))
    obtained = exampleSeq.splitAt(3)

    assert(obtained == expected)
  }

  test("splitAt") {
    expected = MSeqPair(MSeqTranslatorImpl().asMSeq(Seq(0, 1, 1)), MSeqTranslatorImpl().asMSeq(Seq(2, 3, 5, 8)))
    obtained = MinImpl().splitAt(example, 3)

    assert(obtained == expected)
  }

  test("span with Seq") {
    expected = Tuple2(Seq(0, 1, 1, 2, 3), Seq(5, 8))
    obtained = exampleSeq.span(x -> not (x == 5))

    assert(obtained == expected)
  }

  test("span") {
    expected = MSeqPair(MSeqTranslatorImpl().asMSeq(Seq(0, 1, 1, 2, 3)), MSeqTranslatorImpl().asMSeq(Seq(5, 8)))
    obtained = MinImpl().span(example, (x: Int) -> not (x == 5))

    assert(obtained == expected)
  }

  //

  test("append") {
    expected = MSeqTranslatorImpl().asMSeq(Seq(0, 1, 1, 2, 3, 5, 8, 13))
    obtained = MinImpl().appended(example, 13)

    assert(obtained == expected)
  }

  test("last") {
    expected = 8
    obtained = MinImpl().last(example)

    assert(obtained == expected)
  }

  test("concat") {
    expected = MSeqTranslatorImpl().asMSeq(Seq(0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55))
    second = MSeqTranslatorImpl().asMSeq(Seq(13, 21, 34, 55))
    obtained = MinImpl().concat(example, second)

    assert(obtained == expected)
  }

  test("slice with Seq 0") {
    expected = Seq(1, 2, 3)
    obtained = exampleSeq.slice(2, 5)

    assert(obtained == expected)
  }

  test("slice with Seq 1") {
    expected = Seq()
    obtained = exampleSeq.slice(5, 2)

    assert(obtained == expected)
  }

  test("slice with Seq 2") {
    expected = Seq()
    obtained = exampleSeq.slice(3, 3)

    assert(obtained == expected)
  }

  test("slice with Seq 3") {
    expected = Seq()
    obtained = exampleSeq.slice(100, 5)

    assert(obtained == expected)
  }

  test("slice with Seq 4") {
    expected = Seq()
    obtained = exampleSeq.slice(100, 200)

    assert(obtained == expected)
  }

  test("slice with Seq 5") {
    expected = exampleSeq
    obtained = exampleSeq.slice(-100, 200)

    assert(obtained == expected)
  }

  test("slice 0") {
    expected = MSeqTranslatorImpl().asMSeq(Seq(1, 2, 3))
    obtained = MinImpl().slice(example, 2, 5)

    assert(obtained == expected)
  }

  test("slice 1") {
    expected = empty
    obtained = MinImpl().slice(example, 5, 2)

    assert(obtained == expected)
  }

  test("slice 2") {
    expected = empty
    obtained = MinImpl().slice(example, 3, 3)

    assert(obtained == expected)
  }

  test("slice 3") {
    expected = empty
    obtained = MinImpl().slice(example, 100, 5)

    assert(obtained == expected)
  }

  test("slice 4") {
    expected = empty
    obtained = MinImpl().slice(example, 100, 200)

    assert(obtained == expected)
  }

  test("slice 5") {
    expected = example
    obtained = MinImpl().slice(example, -100, 200)

    assert(obtained == expected)
  }

  //

  test("forall with Seq 0") {
    expected = true
    predicate: Int -> Boolean = x -> not (x == 7)
    obtained = exampleSeq.forall(predicate)

    assert(obtained == expected)
  }

  test("forall with Seq 1") {
    expected = false
    predicate: Int -> Boolean = x -> x < 7
    obtained = exampleSeq.forall(predicate)

    assert(obtained == expected)
  }

  test("forall with Seq 2") {
    expected = true
    predicate: Int -> Boolean = x -> x == 7
    obtained = Seq().forall(predicate)

    assert(obtained == expected)
  }

  test("forall 0") {
    expected = true
    predicate: Int -> Boolean = x -> not (x == 7)
    obtained = MinImpl().forall(example, predicate)

    assert(obtained == expected)
  }

  test("forall 1") {
    expected = false
    predicate: Int -> Boolean = x -> x < 7
    obtained = MinImpl().forall(example, predicate)

    assert(obtained == expected)
  }

  test("forall 2") {
    expected = true
    predicate: Int -> Boolean = x -> x == 7
    obtained = MinImpl().forall(empty, predicate)

    assert(obtained == expected)
  }

  test("exists with Seq 0") {
    expected = true
    predicate: Int -> Boolean = x -> x == 8
    obtained = exampleSeq.exists(predicate)

    assert(obtained == expected)
  }

  test("exists with Seq 1") {
    expected = false
    predicate: Int -> Boolean = x -> x == 7
    obtained = exampleSeq.exists(predicate)

    assert(obtained == expected)
  }

  test("exists with Seq 2") {
    expected = false
    predicate: Int -> Boolean = x -> x == 7
    obtained = Seq().exists(predicate)

    assert(obtained == expected)
  }

  test("exists 0") {
    expected = true
    predicate: Int -> Boolean = x -> x == 8
    obtained = MinImpl().exists(example, predicate)

    assert(obtained == expected)
  }

  test("exists 1") {
    expected = false
    predicate: Int -> Boolean = x -> x == 7
    obtained = MinImpl().exists(example, predicate)

    assert(obtained == expected)
  }

  test("exists 2") {
    expected = false
    predicate: Int -> Boolean = x -> x == 7
    obtained = MinImpl().exists(empty, predicate)

    assert(obtained == expected)
  }

  test("find with Seq 0") {
    expected = Some(0)
    predicate: Int -> Boolean = x -> not (x == 7)
    obtained = exampleSeq.find(predicate)

    assert(obtained == expected)
  }

  test("find with Seq 1") {
    expected = Some(8)
    predicate: Int -> Boolean = x -> x == 8
    obtained = exampleSeq.find(predicate)

    assert(obtained == expected)
  }

  test("find with Seq 2") {
    expected = None
    predicate: Int -> Boolean = x -> x == 7
    obtained = Seq().find(predicate)

    assert(obtained == expected)
  }

  test("find 0") {
    expected = SomeSD(0)
    predicate: Int -> Boolean = x -> not (x == 7)
    obtained = MinImpl().find(example, predicate)

    assert(obtained == expected)
  }

  test("find 1") {
    expected = SomeSD(8)
    predicate: Int -> Boolean = x -> x == 8
    obtained = MinImpl().find(example, predicate)

    assert(obtained == expected)
  }

  test("find 2") {
    expected = NoneSD()
    predicate: Int -> Boolean = x -> x == 7
    obtained = MinImpl().find(empty, predicate)

    assert(obtained == expected)
  }

  test("filter with Seq") {
    expected = Seq(0, 3)
    predicate: Int -> Boolean = x -> x % 3 == 0
    obtained = exampleSeq.filter(predicate)

    assert(obtained == expected)
  }

  test("filter") {
    expected = MSeqTranslatorImpl().asMSeq(Seq(0, 3))
    f: Int -> Boolean = x -> x % 3 == 0
    obtained = MinImpl().filter(example, f)

    assert(obtained == expected)
  }

  test("map with Seq") {
    expected = Seq(100, 101, 101, 102, 103, 105, 108)
    f: Int -> Int = x -> x + 100
    obtained = exampleSeq.map(f)

    assert(obtained == expected)
  }

  test("map in the same type") {
    expected = MSeqTranslatorImpl().asMSeq(Seq(100, 101, 101, 102, 103, 105, 108))
    f: Int -> Int = x -> x + 100
    obtained = MinImpl().map0(example, f)

    assert(obtained == expected)
  }

  test("foldLeft with Seq") {
    expected = Seq(108, 105, 103, 102, 101, 101, 100)
    obtained = exampleSeq.foldLeft(Seq[Int]())((s: Seq[Int], e: Int) -> s.+:((e + 100)))

    assert(obtained == expected)
  }

  test("foldLeft in the same type") {
    expected = MSeqTranslatorImpl().asMSeq(Seq(108, 105, 103, 102, 101, 101, 100))
    obtained = MinImpl().foldLeft0(example)(MinImpl().empty,
      (s: MSeq[Int], e: Int) -> MinImpl().prepended(s, e + 100)
    )

    assert(obtained == expected)
  }
}

